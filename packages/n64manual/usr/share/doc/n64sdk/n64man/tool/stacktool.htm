<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../N64man.css">
<!--
Editors Notes:
  PWC- updated formatting
  MAP- updated format
-->
<title>stacktool</title>
</head>

<body bgcolor="#FFFFFF">
<font style="font-size: 12pt"><b>stacktool</b></font><font style="font-size: 9pt"><b> (tool command)</b></font>

<p><i>
A static stack analysis tool for the N64 development system</i></p>

<h3>Syntax</h3>

<p>stacktool [-s segname] [-f resfile] [-r] filename</p>

<h3>Description</h3>

<p>stacktool is a utility that analyzes the stack usage of the target executable file, specified by filename (the binary file). It lists the stack usage of each known function and its descendants in terms of bytes. However, all functions are not fully analyzable at this stage.</p>

<p>If there are recursive calls inside a function or its descendants, an asterisk (*) is attached at the end. If there are unknown jal targets, an at sign (@) is attached. If there are unknown jalr targets, a pound sign (#) is attached. </p>

<p>If the target file is generated by the <a href="makerom.htm">makerom</a> tool, and there is only one text segment, the option [-s segname] need not be specified explicitly.</p>

<p>The -r option tells stacktool to list the parent-child relationship in addition to the stack usage.</p>

<p>The -f option is for the user to provide external information regarding the parent-child relationship. For example, if the program uses pointers to functions, the compiler will generate jalr when the pointer is dereferenced. </p>

<p>The syntax of the statements in the resolution file is: &lt;type&gt; &lt;parent&gt; &lt;children&gt;.
where &lt;type&gt; is either an at sign (@) for an unknown jal or a pound sign (#) for an unknown jalr, &lt;parent&gt; is the name of the function in question, and &lt;children&gt; is the name list of the unknown children of the function. A sample resolution file is provided in the distribution for resolving some jalr problems in the OS. </p>

<p>Command Line Options</p>

<dl>
    <dt><strong>-s segname</strong></dt>
    <dd>The text segment name is specified by segname. For executables generated by the <a href="makerom.htm">makerom</a> tool, it should be something like .codesegment. The default is the name of the first text segment that contains code. <br>
        <br>
        </dd>
    <dt><strong>-f resfile</strong></dt>
    <dd>The resolution file name is specified by resfile. A sample resolution file for resolving unknown jalr in the OS is provided in the distribution. <br>
        <br>
        </dd>
    <dt><strong>-r</strong></dt>
    <dd>Shows parent-child relationship by indentation.<br>
        <br>
        </dd>
</dl>

<h3>Note</h3>

<p>This tool is only trying its best to analyze the static stack usage. If the target contains a lot of recursive calls, uses pointers to functions, or is linked with shared option, stacktool may not be able to provide much help. For thread stack size determination, you need to add 16 to the size reported by the corresponding function due to the calling convention of the MIPS compiler. </p>

<h3>See Also</h3>

<p><a href="makerom.htm">makerom</a></p>
<h3>Revision History</h3>
<p>1999/04/30  Changed Format</p>
<br><br>

</body>
</html>
